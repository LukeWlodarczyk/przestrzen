---
import HR from "@components/typography/HR.astro";

import StickyBox from "@components/layout/StickyBox";

import BREAKPOINTS from "@styles/breakpoints/breakpoints";

import type { PropsWithChildren } from "@utils/types";

const hasRequiredSlots = (slots: string[]) =>
  slots.every((slot) => Astro.slots.has(slot));

if (!hasRequiredSlots(["header", "body", "aside"])) {
  throw new Error(
    'This component requires slots: <slot name="header" />, <slot name="body" />, and <slot name="aside" /> to be provided.',
  );
}

type Props = PropsWithChildren;
---

<article>
  <header class="w-full">
    <slot name="header" />
  </header>

  <HR className="my-(--space-xl-2xl)" />

  <div class="flex flex-col xl:flex-row xl:gap-(--space-xl-2xl)">
    <div class="mx-auto w-full max-w-prose xl:w-2/3">
      <slot name="body" />
    </div>

    <HR className="my-(--space-xl-2xl) xl:hidden" />

    <aside class="w-full xl:w-1/3">
      <StickyBox
        client:media=`(min-width: ${BREAKPOINTS.xl})`
        offsetBottom={24}
        offsetTop={24}
      >
        <slot name="aside" />
      </StickyBox>
    </aside>
  </div>
</article>
